"use strict";var axis=function(t){function e(){render.context(c.ctx).line({left:this.position[0],top:this.position[1],edge:["vertical"===this.direction?this.position[0]:this.position[0]+this.position[2],"vertical"===this.direction?this.position[1]+this.position[2]:this.position[1]]})}function i(t){for(var e=0;e<this.len;e++)t.call(this,this.toDomain[e])}function n(){var t=render.context(c.ctx),e="bottom"===this.location||"right"===this.location?1:-1;this.tickSize=this.tickSize*e,i.call(this,function(e){t.line({top:"vertical"===this.direction?this.scale(e):this.position[1],left:"vertical"===this.direction?this.position[0]:this.scale(e),edge:["vertical"===this.direction?this.position[0]+this.tickSize:this.scale(e),"vertical"===this.direction?this.scale(e):this.position[1]+this.tickSize]})})}function o(t){var e={top:0,left:0},i=scale.getDistance(this.scale,this.toDomain),n=draw.getTextWidth(this.font||"5px",t);switch(this.location){case"top":e.top=this.position[1]-(this.tickSize+2),e.left=this.scale(t)-n/2;break;case"left":e.top=this.scale(t)+i/2,e.left=this.position[0]-(n+this.tickSize+2);break;case"bottom":e.top=this.position[1]+(this.tickSize+2),e.left=this.scale(t)-n/2;break;case"right":e.top=this.scale(t)+i/2,e.left=this.position[0]+(this.tickSize+2)}return e}function a(){console.log(this,this.toDomain);for(var t=render.context(c.ctx),e=0,i=this.toDomain.length;e<i;e++){var n=this.toDomain[e],a=o.call(this,n);a.text=n,a.textBaseline="middle",t.text(a)}}function r(t){t.base&&e.call(t,null),t.ticks&&n.call(t,null),t.text&&a.call(t,null)}var c={};return t.context=function(e){return c.ctx=e,arguments.length?t:c.ctx},t.horizontal=function(e){return e.direction="horizontal",e.toDomain=scale.getDomain(),e.len=scale.getDomainLength(),e.base=void 0===e.base||e.base,e.ticks=void 0===e.ticks||e.ticks,e.tickSize=void 0===e.tickSize?10:e.tickSize,r(e),t},t.vertical=function(e){return e.direction="vertical",e.toDomain=scale.getDomain(),e.len=scale.getDomainLength(),e.base=void 0===e.base||e.base,e.ticks=void 0===e.ticks||e.ticks,e.tickSize=void 0===e.tickSize?5:e.tickSize,r(e),t},t}(axis||{}),config={};config.mutualExColor=function(t){return{A:{bg:"#D3D3D3",ins:"#FFBDE0"},B:{bg:"#FFBDE0",ins:"#5CB755"},D:{bg:"#D3D3D3",ins:"#BDE0FF"},E:{bg:"#BDE0FF",ins:"#5CB755"},M:{bg:"#D3D3D3",ins:"#5CB755"},".":{bg:"#D3D3D3",ins:"#D3D3D3"}}[t]},config.variantColor=function(){},config.groupColor=function(){};var draw=function(t){return t.ctx=null,t.getTextWidth=function(t,e){var i=document.createElement("canvas"),n=i.getContext("2d"),o=0;return i.id="get-text-width",n.font=t,document.body.appendChild(i),o=n.measureText(e).width,document.body.removeChild(document.getElementById("get-text-width")),o},t.randomDraw=function(t,e){return Math.floor(Math.random()*t)+(e||0)},t.getDegree=function(t,e,i,n){var o=i-t,a=n-e,r=Math.atan2(o,a);return{radian:r,degree:Math.floor(180*r/Math.PI)}},t.noOverlap=function(e,i,n){for(var o=i.filter(function(t){return"node"===t.type}),a=i.filter(function(t){return"edge"===t.type}),r=0,c=o.length;r<c;r++){var s=o[r];s.textWidth=t.getTextWidth(e,"14px Calibri",s.text),s.width=s.width||1.2*s.textWidth,s.height=s.height||24,s.radius=5,n&&(s.top=n.members.indexOf(s.text)>-1?t.randomDraw(n.top+s.height/2,.7*n.height-s.height/2):(n.top-0)/2-s.height/2,s.left=t.randomDraw(n.left+n.width-n.left-s.width,n.left)),a.forEach(function(t){t.source=t.source.substring(0,s.text.length)===s.text?s.text:t.source,t.target=t.target.substring(0,s.text.length)===s.text?s.text:t.target,t.id=t.id.substring(0,t.source.length+t.target.length)})}return i},t}(draw||{}),event=function(t){function e(t){function e(e){t({x:e.pageX-i.ctx.canvas.offsetLeft,y:e.pageY-i.ctx.canvas.offsetTop})}if(!i.ctx)throw new Error("Not found context of canvas.");i.ctx.canvas.removeEventListener("mousemove",e),i.ctx.canvas.addEventListener("mousemove",e)}var i={};return t.context=function(e){return i.ctx=e,arguments.length?t:i.ctx},t.data=function(e){return i.data=e,arguments.length?t:i.data},t.hover=function(t){e(function(t){})},t}(event||{}),exclusive=function(){function t(t,e){for(var i in e){var n=document.createElement("div");n.id=i,n.style.width=e[i].w+"px",n.style.height=e[i].h+"px",t.appendChild(n)}}function e(t,e){var i=t.replace(/\s/g,""),n=t.split(" "),o=[];e.split("\n\n").filter(function(t,e){var n=/[\[][\w(\s|,)]+[\]]/g.exec(t.split("\n"))[0].replace(/\[|\]|\s/g,"");if(i.indexOf(n)>-1)return t})[0].split("\n").filter(function(t,e){if(e>0){var i=0,a=0,r="";n.forEach(function(e){t.indexOf(e)>-1&&(i=t.indexOf(e),a=e.length)}),r=t.substring(i,i+a),t.substring(0,i-2).split("").forEach(function(t,e){o.push({x:e,y:r,value:t})})}});return o}function i(t){for(var e={},i=0,n=t.length;i<n;i++)e[t[i].y]=1;return{x:[0,t.length/Object.keys(e).length],y:Object.keys(e)}}return function(n){var o=n.element||null,a=document.querySelector(o),r=parseFloat(n.width||a.style.width||800),c=parseFloat(n.height||a.style.height||400);t(a,size.chart.mutualExt(a,r,c));var s="MAPK1 BRAF KRAS NF1 EGFR HGF",l=(new RegExp(s.replace(/\s/g,"|"),"ig"),e(s,n.heatmap));heatmap({data:l,margin:[20,40,20,20],element:"#heatmap",axis:{x:{location:"bottom",scale:"ordinal",data:i(l).x,ticks:!1,base:!1,text:!1},y:{location:"left",scale:"ordinal",data:i(l).y,ticks:!1,base:!1}},rect:[function(t){return{top:t.scaleY(t.y)+1,left:t.scaleX(t.x)+.25,width:t.scaleX.bandwidth()+.5,height:t.scaleY.bandwidth()-2,fillStyle:config.mutualExColor(t.value).bg}},function(t){var e=0,i=t.scaleY.bandwidth();return"M"!==t.value&&"B"!==t.value&&"E"!==t.value||(i=e=t.scaleY.bandwidth()/3),{top:t.scaleY(t.y)+e+1,left:t.scaleX(t.x)+.25,width:t.scaleX.bandwidth()+.5,height:i-2,fillStyle:config.mutualExColor(t.value).ins}}]}),survival({element:"#survival"})}}(),force=function(t){return t.setConstant=function(e){return t.constant=e||50,model},t.getConstant=function(){return t.constant||50},t.getKvalue=function(e,i){var n=t.getConstant();return Math.sqrt(e*i)/n},t.aForce=function(t,e){return e*e/t},t.rForce=function(t,e){return t*t/e},t}(force||{}),heatmap=function(t){function e(t,e,i,n){switch(t){case"top":return[n.left,n.top,e-n.right];case"left":return[n.left,n.top,i-n.bottom];case"bottom":return[n.left,i-n.bottom,e-n.right];case"right":return[e-n.right,n.top,i-n.bottom];default:throw new Error("Not defined location information.")}}return function(t){console.log(t);var i=document.querySelector(t.element),n=parseFloat(t.width||i.style.width||588),o=parseFloat(t.height||i.style.height||300),a=size.setMargin(t.margin)||{top:0,left:0,bottom:0,right:0},r=render.createCanvas(t.element.replace("#",""),n,o),c=r.getContext("2d"),s=render.context(c),l=t.axis.x,h=t.axis.y,d=l.location||"bottom",u=h.location||"left",g=l.range||"normal",f=h.range||"normal",x=scale[l.scale](l.data,"riverse"===g?[n-a.right,a.left]:[a.left,n-a.right]),p=scale[h.scale](h.data,"riverse"===f?[o-a.bottom,a.top]:[a.top,o-a.bottom]),v=t.rect.length<1?[t.rect]:t.rect;e(d,n,o,a);i.appendChild(r),axis.context(c).horizontal({scale:x,location:d,position:e(d,n,o,a),ticks:void 0===l.ticks||l.ticks,base:void 0===l.base||l.base,text:void 0===l.text||l.text}).vertical({scale:p,location:u,position:e(d,n,o,a),ticks:void 0===h.ticks||h.ticks,base:void 0===h.base||h.base,text:void 0===h.text||h.text});for(var m=0,b=t.data.length;m<b;m++){t.data[m].scaleX=x,t.data[m].scaleY=p;for(var w=0,y=v.length;w<y;w++)s.rect(v[w](t.data[m]))}}}();!function(t){t.bio={draw:draw,render:render,variants:variants,pathways:"",expression:"",landscape:"",exclusive:exclusive,chart:{legend:"",needle:"",graph:"",procbar:"",title:"",network:network,heatmap:heatmap,survival:survival},size:size,scale:scale,event:event}}(window||{});var network=function(){return function(t){var e=[],i={},n="";t.data.map(function(t){if("compound"===t.type)n=t.members,e.push({group:"nodes",data:{id:"n0",bgcolor:t.bgcolor,bdcolor:t.bordercolor||"rgb(0, 0, 0)",width:100,height:100,isComp:!0,per:t.text},position:{}});else if("node"===t.type){var o={data:{id:n.indexOf(t.text)>-1?"n0:"+t.text:t.text,name:t.text,bgcolor:t.bgcolor,bdcolor:t.bordercolor||"rgb(0, 0, 0)",width:draw.getTextWidth("14px Calibri",t.text),height:15,isComp:!1},group:"nodes"};i[t.text]={parent:n.indexOf(t.text)>-1?"n0:":""},n.indexOf(t.text)>-1&&(o.data.parent="n0"),e.push(o)}else if("edge"===t.type){var a="",r="",c="";for(var s in i)t.source.substring(0,s.length)===s&&(a=i[s].parent+s,c=t.source.substring(s.length,t.source.length),r=i[t.target.substring(0,t.target.indexOf(c))].parent+t.target.substring(0,t.target.indexOf(c)));e.push({data:{id:a+r,source:a,target:r,color:t.linecolor},group:"edges"})}});cytoscape({container:document.querySelector(t.element),boxSelectionEnabled:!1,autoungrabify:!0,autounselectify:!0,fit:!0,padding:10,pixelRatio:"auto",elements:e,style:cytoscape.stylesheet().selector("node").css({shape:"rectangle",width:"data(width)",height:"data(height)","font-size":"10",content:"data(name)","text-valign":"center","background-color":"data(bgcolor)","border-color":"data(bdcolor)","border-width":"1"}).selector(":parent").css({"background-color":"rgba(255, 255, 255, 0.5)","border-color":"rgb(150, 0, 0)","border-width":"1",content:"data(per)","font-size":"12","text-valign":"top"}).selector("edge").css({"curve-style":"bezier","target-arrow-shape":"triangle","target-arrow-color":"data(color)","arrow-scale":"1","line-color":"data(color)"}),layout:{name:"cose-bilkent",animate:!1}})}}(),render=function(t){function e(t){t.fillStyle="#000000",t.strokeStyle="#000000",t.shadowColor="#000000",t.shadowBlur="0",t.shadowOffsetX="0",t.shadowOffsetY="0"}function i(t,i){e(t);for(var n in i)if(t[n])switch(t[n]=i[n],n){case"fillStyle":t.fill();break;case"strokeStyle":t.stroke();break;case"dashed":t.setLineDash([3,10])}}return t.ctx=null,t.text=function(e){return t.ctx.beginPath(),i(t.ctx,e),t.ctx.fillText(e.text,e.left,e.top),t.ctx.closePath(),t},t.line=function(e){return t.ctx.beginPath(),t.ctx.moveTo(e.left,e.top),2===e.edge.length&&"object"!=typeof e.edge[0]?function(){t.ctx.lineTo(e.edge[0],e.edge[1])}():function(){for(var i=0,n=e.edge.length;i<n;i++)t.ctx.lineTo(e.edge[i][0],e.edge[i][1])}(),i(t.ctx,e),t.ctx.stroke(),t.ctx.closePath(),t},t.rect=function(e){return t.ctx.beginPath(),t.ctx.rect(e.left,e.top,e.width,e.height),i(t.ctx,e),t.ctx.closePath(),t},t.rounded=function(e){return t.ctx.beginPath(),t.ctx.moveTo(e.left+e.radius,e.top),t.ctx.lineTo(e.left+e.width-e.radius,e.top),t.ctx.arcTo(e.left+e.width,e.top,e.left+e.width,e.top+e.radius,e.radius),t.ctx.lineTo(e.left+e.width,e.top+e.height-e.radius),t.ctx.arcTo(e.left+e.width,e.top+e.height,e.left+e.width-e.radius,e.top+e.height,e.radius),t.ctx.lineTo(e.left+e.radius,e.top+e.height),t.ctx.arcTo(e.left,e.top+e.height,e.left,e.top+e.height-e.radius,e.radius),t.ctx.lineTo(e.left,e.top+e.radius),t.ctx.arcTo(e.left,e.top,e.left+e.radius,e.top,e.radius),i(t.ctx,e),t.ctx.closePath(),t},t.arrow=function(e){var n=Math.atan2(e.height-e.top,e.width-e.left);t.ctx.beginPath(),t.ctx.moveTo(e.left,e.top),t.ctx.lineTo(e.width,e.height),t.ctx.lineTo(e.width-e.headLen*Math.cos(n-Math.PI/6),e.height-e.headLen*Math.sin(n-Math.PI/6)),t.ctx.moveTo(e.width,e.height),t.ctx.lineTo(e.width-e.headLen*Math.cos(n+Math.PI/6),e.height-e.headLen*Math.sin(n+Math.PI/6)),i(t.ctx,e),t.ctx.closePath()},t.getRatio=function(){var t=document.createElement("canvas").getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},t.context=function(e){return t.ctx=e,t},t.createCanvas=function(e,i,n,o){o=o||t.getRatio();var a=document.createElement("canvas");return a.id=e,a.width=i*o,a.height=n*o,a.style.width=i+"px",a.style.height=n+"px",a.getContext("2d").setTransform(o,0,0,o,0,0),a},t}(render||{}),scale=function(t){function e(t,e){var n=[];if("number"==typeof e[0]&&"number"==typeof e[0]){for(var o=Math.max(e[0],e[1]),a=Math.min(e[0],e[1]),r=o-a,c=a;c<r;c++)n.push(c);return i.data.push(n),i.len.push(r),"ordinal"===t?n:[a,o]}return i.data.push(e),i.len.push(e.length),e}var i={data:[],len:[]};return t.ordinal=function(t,i){return d3.scaleBand().domain(e("ordinal",t)).range(i)},t.linear=function(t,i){return d3.scaleLinear().domain(e("linear",t)).range(i)},t.getDomain=function(){return i.data.shift()},t.getDomainLength=function(){return i.len.shift()},t.getDistance=function(t,e){return e.length<2?t(e[0]):t(e[1])-t(e[0])},t.date=function(){console.log("Date")},t}(scale||{}),size={};size.setMargin=function(t){if("number"==typeof t)return{top:t,left:t,bottom:t,right:t};switch(t.length){case 1:return{top:t[0],left:t[0],bottom:t[0],right:t[0]};case 2:return{top:t[0],left:t[1],bottom:t[0],right:t[1]};case 3:return{top:t[0],left:t[1],bottom:t[2],right:t[1]};case 4:default:return{top:t[0],left:t[1],bottom:t[2],right:t[3]}}},size.chart={},size.chart.mutualExt=function(t,e,i){return t.style.width=e+"px",t.style.height=i+"px",{survival:{w:.3*e,h:i},selectBox:{w:.7*e,h:.05*i},separateBar:{w:.7*e,h:.05*i},group:{w:.7*e,h:.4*i},network:{w:.7*e*.3,h:.5*i},heatmap:{w:.7*e*.7,h:.5*i}}};var survival=function(t){return function(t){var e=t.element||null,i=document.querySelector(e),n=parseFloat(t.width||i.style.width||360),o=parseFloat(t.height||i.style.height||600),a=render.createCanvas(e.substring(1,e.length),n,o),r=a.getContext("2d");i.appendChild(a),event.context(r).hover(function(t){console.log(t)})}}(),variants=function(){return function(t){var e=t.element||null,i=document.querySelector(e),n=t.width||i.style.width||1200,o=t.height||i.style.height||600;console.log("Variants","\nElement: ",e,"\nWidth: ",n,"\nHeight: ",o)}}();