function needleRadius(t){return 3*Math.sqrt(t)/1.25}var axis=function(t){"use strict";function e(t,e){return d3.axisTop?i(t,e):n(t,e)}function n(t,e){return d3.svg.axis().scale(t).orient(e)}function i(t,e){return d3["axis"+util.camelCase(e)](t)}function a(e,n,i){return util.loop(n,function(n,a){e[n]&&e[n](t.option[n](i,a))}),e}function r(t,e){return e?t.selectAll(e).remove():t}var o={axies:{}};return t.element=function(e){return e="Object"===util.varType(e)?e:/\W/.test(e[0])?d3.select(e):d3.select("#"+e),o.current=e,t},t.option={tickValues:function(t,e){for(var n=util.minmax(t).max/(e-1),i=[],a=0;a<e-1;a++)i.push(a*n);return i.push(util.minmax(t).max),i}},t.top=function(t){var n=size.setMargin(t.margin),i=draw.size(o.current),l=t.position||[n.top,n.left],s=scale.get(t.data,[n.left,i.w-n.right]),c=render.addGroup(o.current,l[0],l[1]);return c.call(a(e(s,"top"),t.opt,t.data)),r(c,t.opt.remove),c},t.left=function(t){var n=size.setMargin(t.margin),i=draw.size(o.current),l=t.position||[n.top,i.w-n.right],s=scale.get(t.data,[n.top,i.h-n.bottom]),c=render.addGroup(o.current,l[0],l[1]);return c.call(a(e(s,"left"),t.opt,t.data)),r(c,t.opt.remove),c},t.bottom=function(t){var n=size.setMargin(t.margin),i=draw.size(o.current),l=t.position||[i.h-n.bottom,n.left],s=scale.get(t.data,[n.left,i.w-n.right]),c=render.addGroup(o.current,l[0],l[1]);return c.call(a(e(s,"bottom"),t.opt,t.data)),r(c,t.opt.remove),c},t.right=function(t){var n=size.setMargin(t.margin),i=draw.size(o.current),l=t.position||[n.top,n.left],s=scale.get(t.data,[n.top,i.h-n.bottom]),c=render.addGroup(o.current,l[0],l[1]);return c.call(a(e(s,"right"),t.opt,t.data)),r(c,t.opt.remove),c},t}(axis||{}),bar=function(t){"use strict";function e(t){var e=draw.size(i.e),n=[i.m.left,(i.w||e.w)-i.m.right],a=[i.m.top,(i.h||e.h)-i.m.bottom];return{x:"top"===t||"bottom"===t||"right"===t?n:n.reverse(),y:"left"===t||"right"===t||"bottom"===t?a:a.reverse()}}function n(t,n,i){return scale.get(n,e(t)[i])}var i={};return function(t){(i={}).e=t.element="Object"===util.varType(t.element)||"Array"===util.varType(t.element)?t.element:/\W/.test(t.element[0])?d3.select(t.element):d3.select("#"+t.element),i.w=t.width||null,i.h=t.height||null,i.m=size.setMargin(t.margin),i.t=i.m.top||0,i.l=i.m.left||0,i.g=render.addGroup(i.e,i.t,i.l),i.dx=t.xaxis,i.dy=t.yaxis,i.sx=n(t.direction,t.xaxis,"x"),i.sy=n(t.direction,t.yaxis,"y");var e=i.e.attr("id");return render.rect({element:i.g.selectAll("#"+e+"_rect"),data:t.data,attr:{id:function(t){return e+"_rect"},x:function(e){return t.attr.x?t.attr.x.call(i,e):t.attr.x(e)},y:function(e){return t.attr.y?t.attr.y.call(i,e):t.attr.y(e)},width:function(e){return t.attr.width?t.attr.width.call(i,e):t.attr.width(e)},height:function(e){return t.attr.height?t.attr.height.call(i,e):t.attr.height(e)}},style:{fill:function(e){return t.style.fill?t.style.fill(e):"#000000"},stroke:function(e){return t.style.stroke?t.style.stroke(e):"#FFFFFF"}}}),i}}(),config={exclusivity:{},landscape:{},variants:{}};config.landscape.name=function(t){return t=t.replace(/(_ins|_del)$/gi,"_indel"),t=t.substring(0,1).toUpperCase()+t.substring(1).toLowerCase()},config.landscape.case=function(t){switch(config.landscape.priority(config.landscape.name(t))){case 0:case 1:return"cnv";default:return"var"}},config.landscape.priority=function(t){return{Amplification:0,Homozygous_deletion:1,Nonsense_mutation:2,Splice_site:3,Translation_start_site:4,Missense_mutation:5,Start_codon_snp:5,Nonstop_mutation:6,Frame_shift_indel:7,Stop_codon_indel:7,In_frame_indel:8,Silent:9,Rna:10,Intron:11,"5'utr":11,"3'utr":11,Igr:11}[t]},config.landscape.color=function(t){return{Amplification:"#FFBDE0",Homozygous_deletion:"#BDE0FF",Nonsense_mutation:"#EA3B29",Splice_site:"#800080",Translation_start_site:"#AAA8AA",Missense_mutation:"#3E87C2",Start_codon_snp:"#3E87C2",Nonstop_mutation:"#070078",Frame_shift_indel:"#F68D3B",Stop_codon_indel:"F68D3B",In_frame_indel:"#F2EE7E",Silent:"#5CB755",Rna:"#FFDF97",Intron:"#A9A9A9","5'utr":"#A9A9A9","3'utr":"#A9A9A9",Igr:"#A9A9A9",dead:"#C50E36",alive:"#04CDA4",male:"#0F67B6",female:"E0A4E5",white:"#9CB1CE","black or african american":"#302F24",asian:"#CB771F","american indian or alaska native":"#38120B","hispanic or latino":"#B8642F","not hispanic or latino":"#55C53E","lung acinar adenocarcinoma":"#716190","lung adenocarcinoma mixed subtype":"#5154DE","lung adenocarcinoma- not otherwise specified (nos)":"#8E9A7E","lung bronchioloalveolar carcinoma mucinous":"#2F91DE","lung bronchioloalveolar carcinoma nonmucinous":"#ED6EBD","lung clear cell adenocarcinoma":"#1C8D7A","lung micropapillary adenocarcinoma":"#B2EE86","lung mucinous adenocarcinoma":"#785E54","lung papillary adenocarcinoma":"#69B4C4","lung signet ring adenocarcinoma":"#C1386E","lung solid pattern predominant adenocarcinoma":"#D7A355","mucinous (colloid) carcinoma":"#243833",bronchial:"#F9E3B9","l-lower":"#FBA2A3","l-upper":"#0CA3C7","other (please specify)":"#D3A16C","r-lower":"#388A4E","r-middle":"#D61E43","r-upper":"#B81BCC",no:"#D73A64",yes:"#1990AA","yes, history of prior malignancy":"#3BDB11","yes, history of synchronous/bilateral malignancy":"#803F11",no:"#D73A64",yes:"#1990AA",no:"#D73A64",yes:"#1990AA",t1:"#060CDB",t1a:"#696DE9",t1b:"#CDCEF7",t2:"#F6251D",t2a:"#F96D69",t2b:"#FDCECD",t3:"#1AEB42",t4:"#EBBD34",tx:"#9943DE",n0:"#DC5B35",n1:"#217C1F",n2:"#18A6F3",n3:"#EA68C3",nx:"#F4E831",m0:"#F0820D",m1:"#C45A43",m1a:"#A523C2",m1b:"#C97BDA",mx:"#EDD3F2","stage i":"#01C606","stage ia":"#018404","stage ib":"#002C01","stage ii":"#0E22C3","stage iia":"#08136C","stage iib":"#040B41","stage iiia":"#BB0C2E","stage iiib":"#75081D","stage iv":"#F0CA53",r0:"#DB8EC0",r1:"#FFD046",r2:"#495C50",rx:"#0E5F8A","exon 19 deletion":"#4A312A",l858r:"#74C04C",l861q:"#FBED09",other:"#C91DAB",t790m:"#2C517B",g12a:"#DED0D1",g12c:"#AE8A8E",g12d:"#5D161D",g12s:"#410F14",g12v:"#25080B",other:"#C91DAB","complete remission/response":"#BDED73","partial remission/response":"#8649F3","progressive disease":"#C1746B","stable disease":"#CD4C2A","complete remission/response":"#BDED73","partial remission/response":"#8649F3","progressive disease":"#C1746B","stable disease":"#CD4C2A","Lifelong Non-Smoker":"#C4B5BB","Current Smoker":"#896C78","Current Reformed Smoker for > 15 yrs":"#3B0A1E","Current Reformed Smoker for < or = 15 yrs":"#2F0818","Current Reformed Smoker, Duration Not Specified":"#17040C",NA:"#D6E2E3"}[t]},config.landscape.sample={attr:{x:function(t){return t.x.indexOf("-")>-1?this.sx(t.x):this.sx(t.x)+3},y:function(t){return this.sy(util.minmax(this.dy).max)-this.sy(t.y+t.value)+this.sy(util.minmax(this.dy).min)},width:function(t){return t.x.indexOf("-")>-1?scale.compatibleBand(this.sx):scale.compatibleBand(this.sx)-7.5},height:function(t){return this.sy(t.value)-this.sy(util.minmax(this.dy).min)}},style:{fill:function(t){return config.landscape.color(t.info)},stroke:function(t){return"#FFFFFF"}}},config.landscape.gene={attr:{x:function(t){return this.sx(util.minmax(this.dx).max-t.x)-this.sx(t.value)+this.m.left},y:function(t){return this.sy(t.y)},width:function(t){return this.sx(t.value)-this.m.left},height:function(t){return scale.compatibleBand(this.sy)}},style:{fill:function(t){return config.landscape.color(t.info)},stroke:function(t){return"#FFFFFF"}}},config.landscape.pq={attr:{x:function(t){return this.sx(util.minmax(this.dx).min)},y:function(t){return this.sy(t.y)},width:function(t){return this.sx(t.value)},height:function(t){return scale.compatibleBand(this.sy)}},style:{fill:function(t){return"#BFBFBF"},stroke:function(t){return"#FFFFFF"}}},config.landscape.heatmap={attr:{x:function(t){return this.sx(t.x)},y:function(t){return"cnv"!==config.landscape.case(t.value)?scale.compatibleBand(this.sy)/3+this.sy(t.y):this.sy(t.y)},width:function(t){return scale.compatibleBand(this.sx)},height:function(t){return"cnv"!==config.landscape.case(t.value)?scale.compatibleBand(this.sy)/3:scale.compatibleBand(this.sy)}},style:{fill:function(t){return config.landscape.color(t.value)},stroke:function(t){return"#FFFFFF"}}},config.landscape.group={attr:{x:function(t){return this.sx(t.x)},y:function(t){return this.sy(t.y)},width:function(t){return scale.compatibleBand(this.sx)},height:function(t){return scale.compatibleBand(this.sy)}},style:{fill:function(t){return config.landscape.color(t.value)},stroke:function(t){return"#FFFFFF"}}},config.landscape.legend={attr:{x:function(t,e){var n="h"===this.dr?(2*this.p+this.mw)*e:0;return this.isText?n+2*this.p:n},y:function(t,e){var n=this.height||15,i="h"===this.dr?0:(this.p+this.mh)*e;return this.isText?i+this.mh-this.mh/2+this.p/2:config.landscape.case(t)&&"var"===config.landscape.case(t)?i+n/3:i},width:function(t,e){return this.width||5},height:function(t,e){var n=this.height||15;return config.landscape.case(t)&&"var"===config.landscape.case(t)?n/3:n}},style:{fill:function(t){return config.landscape.color(t)},stroke:function(t){return"#FFFFFF"},fontFamily:function(t){return"Times Roman"},fontSize:function(t){return"12px"}},text:function(t){return t}},config.landscape.axis={sample:{direction:"left",margin:[5,0,10,5],opt:{tickValues:3}},group:{direction:"right",margin:[0,0,0,0],opt:{remove:"line, path"}},gene:[{direction:"right",margin:[5,150,40,0],opt:{remove:"line, path"}},{direction:"bottom",margin:[0,10,35,71],opt:{tickValues:3}}],pq:{direction:"bottom",margin:[0,10,35,20],opt:{tickValues:3}}},config.landscape.bar={pq:{direction:"right",margin:[5,10,41,30],xaxis:function(){return this.pq.x},yaxis:function(){return this.pq.y},attr:config.landscape.pq.attr,style:config.landscape.pq.style}},config.landscape.stack={patient:{direction:"top",margin:[5,0,10,0],xaxis:function(){return this.patient.x},yaxis:function(){return this.sample.y},attr:config.landscape.sample.attr,style:config.landscape.sample.style},sample:{direction:"top",margin:[5,1,10,1],xaxis:function(){return this.sample.x},yaxis:function(){return this.sample.y},attr:config.landscape.sample.attr,style:config.landscape.sample.style},gene:{direction:"left",margin:[5,10,41,70],xaxis:function(){return this.gene.x},yaxis:function(){return this.gene.y},attr:config.landscape.gene.attr,style:config.landscape.gene.style}},config.landscape.heatmap={heatmap:{direction:"left",margin:[5,1,41,1],opt:{},xaxis:function(){return this.sample.x},yaxis:function(){return this.gene.y},attr:config.landscape.heatmap.attr,style:config.landscape.heatmap.style},patient:{direction:"left",margin:[5,1,41,3.5],opt:{},xaxis:function(){return this.patient.x},yaxis:function(){return this.gene.y},attr:config.landscape.heatmap.attr,style:config.landscape.heatmap.style}},config.landscape.group={group:{direction:"left",margin:[2,1,4,1],opt:{},xaxis:function(){return this.sample.x},attr:config.landscape.group.attr,style:config.landscape.group.style},patient:{direction:"left",margin:[2,1,4,4],opt:{},xaxis:function(){return this.patient.x},attr:config.landscape.group.attr,style:config.landscape.group.style}},config.exclusivity.separate=function(t){return"B"===t?["A","M"]:"E"===t?["D","M"]:"M"===t?[".","M"]:[t]},config.exclusivity.name=function(t){return{A:"Amplification",D:"Deletion",M:"Mutation",".":"None"}[t]},config.exclusivity.priority=function(t){return{Amplification:0,Deletion:1,Mutation:2,None:3}[t]},config.exclusivity.color=function(t){return{Amplification:"#FFBDE0",Deletion:"#BDE0FF",Mutation:"#5CB755",None:"#D3D3D3"}[t]},config.exclusivity.legend={margin:[30,80,0,0],attr:{x:function(t,e){var n="h"===this.dr?(10*this.p+this.mw)*e:0;return this.isText?n+2*this.p:n},y:function(t,e){var n=this.height||15,i="h"===this.dr?0:(this.p+this.mh)*e;return this.isText?i+this.mh-this.mh/2+this.p/2:"Mutation"===t?i+n/3:i},width:function(t,e){return this.width||5},height:function(t,e){var n=this.height||15;return"Mutation"===t?n/3:n}},style:{fill:function(t){return config.exclusivity.color(t)},fontSize:function(t){return"12px"},fontFamily:function(t){return"Times Roman"}},text:function(t){return t}},config.exclusivity.heatmap={margin:[35,40,35,50],attr:{x:function(t){return this.sx(t.x)},y:function(t){return"Mutation"===t.value?this.sy(t.y)+scale.compatibleBand(this.sy)/3:this.sy(t.y)},width:function(t){return scale.compatibleBand(this.sx)},height:function(t){return"Mutation"===t.value?scale.compatibleBand(this.sy)/3:scale.compatibleBand(this.sy)}},style:{fill:function(t){return config.exclusivity.color(t.value)},stroke:function(t){return"#FFFFFF"}}},config.exclusivity.division={margin:[11,40,0,48],dashed:"4, 5",attr:{x:function(t){return this.sx?this.sx(t.value):0},y:function(t){return this.sy?this.sy(t.value):0},width:function(t){return"h"===this.direction?t.size:this.w},height:function(t){return"h"!==this.direction?t.size:this.h}},style:{fill:function(t,e){return t.color},stroke:function(t,e){return"#FFFFFF"}}},config.variants.legend={margin:[20,20,0,0],attr:{x:function(t,e){var n="h"===this.dr?(10*this.p+this.mw)*e:this.isText?this.p:0;return this.isText?n+2*this.p:n},y:function(t,e){var n=this.height||5;return this.isText?this.mh*e+.7*n:this.mh*e},r:function(t){return 5}},style:{fontSize:function(t){return"12px"},fill:function(t){return config.landscape.color(t)}},text:function(t){return t}},config.variants.needle={margin:[20,30,100,60],attr:{x:function(t,e){return this.sx(t.x)},y:function(t,e){return this.sy(t.y)},r:function(t,e){return t.value?needleRadius(t.value):this.radius}},style:{fill:function(t){return!!t.info&&config.landscape.color(t.info[0].type)},stroke:function(t){return"#FFFFFF"}}},config.variants.needleGraph={margin:[0,30,80,60],attr:{x:function(t,e){return this.isText?this.sx(t.x)+5:this.sx(t.x)},y:function(t,e){return this.isText?this.sh/2:0},width:function(t,e){return this.sx(t.width)},height:function(t,e){return this.sh}},style:{fill:function(t){return t.color},stroke:function(t){return"#FFFFFF"}},text:function(t){return t.info.identifier}},config.variants.axis={left:{margin:[20,60,100,0]},top:{margin:[2,30,0,60]}},config.variants.navi={margin:[0,30,5,60],style:{fill:function(t){var e=!!t.info&&d3.rgb(config.landscape.color(t.info[0].type));return this.g.selectAll("path").style("stroke","rgba(0, 0, 0, 0.1)"),!!e&&(e.opacity=.3,e)}}},config.variants.patient={needle:{margin:[0,30,48,60],attr:{points:function(t,e){var n=this.s(t.position);return n+","+this.len/2.5+" "+(n-this.len)+","+2*this.len+" "+(n+this.len)+","+2*this.len+" "+n+","+this.len/2.5}},style:{fill:function(t,e){return config.landscape.color(t.type)},stroke:function(t,e){var n=d3.rgb(config.landscape.color(t.type));return n.opacity=.3,n}}},legend:{margin:[0,0,0,0],attr:{points:function(t,e){var n=document.querySelector("#variants_legend_chart").firstChild.getBoundingClientRect(),i=n.right-n.left+n.width;return i+","+(n.bottom-n.width)+" "+(i-n.width/2)+","+n.bottom+" "+(i+n.width/2)+","+n.bottom+" "+i+","+(n.bottom-n.width)},x:function(t,e){var n=document.querySelector("#variants_legend_chart").firstChild.getBoundingClientRect();return n.right-n.left+2*n.width+this.p},y:function(t,e){return document.querySelector("#variants_legend_chart").firstChild.getBoundingClientRect().bottom}},style:{fill:function(t,e){return config.landscape.color(t.type)},stroke:function(t,e){var n=d3.rgb(config.landscape.color(t.type));return n.opacity=.3,n},fontSize:function(t){return"12px"},strokeWidth:function(t){return"3px"}},text:function(t){return"Patients"}}};var divisionLine=function(t){"use strict";function e(){return{first:i[i.sw](i.point)-i[i.sw](i.a[0]),last:i[i.sw](i.a[i.a.length-1])-i[i.sw](i.point)}}function n(t,e){for(var n=1,t=t/3;draw.getTextHeight(n+"px").height<t;)n+=1;return n+"px"}var i={};return function(t){(i={}).e=t.element="Object"===util.varType(t.element)||"Array"===util.varType(t.element)?t.element:/\W/.test(t.element[0])?d3.select(t.element):d3.select("#"+t.element),i.m=size.setMargin(t.margin),i.s=draw.size(i.e),i.t=i.m.top||0,i.l=i.m.left||0,i.direction=t.direction||"h",i.point=t.point||0,i.a=t.axis,i.sw="s"+("h"===i.direction?"x":"y"),i[i.sw]=scale.get(t.axis,"h"===i.direction?[i.m.left,i.s.w-i.m.right]:[i.m.top,i.s.h-i.m.bottom]),i.g=render.addGroup(i.e,i.t,i.l),i.lg=render.addGroup(i.e,i.t,i.l),i.h=t.height||30,i.w=t.width||30,i.th=n(i.h),i.line=(util.d3v4()?d3.line():d3.svg.line()).x(function(t){return t.x}).y(function(t){return t.y});var a=e();render.rect({element:i.g.selectAll("#"+i.e.attr("id")+"_div"),data:[{value:t.axis[0],color:t.color[0],size:a.first},{value:t.point,color:t.color[1],size:a.last}],attr:{id:function(t){return i.e.attr("id")+"_div"},x:function(e){return t.attr.x?t.attr.x.call(i,e):0},y:function(e){return t.attr.y?t.attr.y.call(i,e):0},width:function(e){return t.attr.width?t.attr.width.call(i,e):i.w},height:function(e){return t.attr.height?t.attr.height.call(i,e):i.h},rx:5,ry:5},style:{fill:function(e,n){return t.style.fill?t.style.fill.call(i,e,n):"#000000"},stroke:function(e,n){return t.style.stroke?t.style.stroke.call(i,e,n):"#FFFFFF"}}}),render.text({element:i.g.selectAll("#"+i.e.attr("id")+"_text"),data:[{text:t.text[0]},{text:t.text[1]}],attr:{id:i.e.attr("id")+"_text",x:function(t,e){return 0===e?i[i.sw](i.a[0])+5:i[i.sw](i.a[i.a.length-1])-5},y:function(t,e){return i.h-.25*i.h}},style:{fill:"#F1F1F1","text-anchor":function(t,e){return 0===e?"start":"end"},"alignment-baseline":"middle","font-size":i.th,"font-weight":"bold","text-shadow":"1px 1px rgba(0, 0, 0, 0.5)"},text:function(t){return t.text}}),render.line({element:i.lg,attr:{id:function(t){return i.e.attr("id")+"_line"},d:i.line([{x:i[i.sw](i.point),y:i.h},{x:i[i.sw](i.point),y:i.s.h}]),"stroke-dasharray":t.dashed||"0","stroke-width":.8},style:{stroke:"#000000"}})}}(),draw=function(t){"use strict";return t.ctx=null,t.clearCanvas=function(t){t.children.length>0&&t.removeChild(t.firstChild)},t.width=function(t){return"string"==typeof t?parseFloat(document.querySelector(t)):parseFloat(t.style.width)},t.height=function(t){return"string"==typeof t?parseFloat(document.querySelector(t)):parseFloat(t.style.height)},t.getTextWidth=function(t,e){var n=document.createElement("canvas"),i=n.getContext("2d"),a=0;return n.id="get-text-width",i.font=(e||"10px")+"arial",document.body.appendChild(n),a=i.measureText(t).width,document.body.removeChild(document.getElementById("get-text-width")),a},t.getTextHeight=function(t,e){var n=document.createElement("span"),i=document.createElement("div"),a=document.createElement("div");a.id="get_text_height",n.style.fontSize=t||"10px",n.style.fontStyle=e||"Arial",n.innerHTML="Hg",i.style.display="inline-block",i.style.width="1px",i.style.height="0px",a.appendChild(n),a.appendChild(i),document.querySelector("body").appendChild(a);try{var r={};i.style.verticalAlign="baseline",r.ascent=i.offsetTop-n.offsetTop,i.style.verticalAlign="bottom",r.height=i.offsetTop-n.offsetTop,r.descent=r.height-r.ascent}finally{a.parentNode.removeChild(document.getElementById("get_text_height"))}return r},t.randomDraw=function(t,e){return Math.floor(Math.random()*t)+(e||0)},t.getDegree=function(t,e,n,i){var a=n-t,r=i-e,o=Math.atan2(a,r);return{radian:o,degree:Math.floor(180*o/Math.PI)}},t.noOverlap=function(e,n,i){for(var a=n.filter(function(t){return"node"===t.type}),r=n.filter(function(t){return"edge"===t.type}),o=0,l=a.length;o<l;o++){var s=a[o];s.textWidth=t.getTextWidth(e,"14px Calibri",s.text),s.width=s.width||1.2*s.textWidth,s.height=s.height||24,s.radius=5,i&&(s.top=i.members.indexOf(s.text)>-1?t.randomDraw(i.top+s.height/2,.7*i.height-s.height/2):(i.top-0)/2-s.height/2,s.left=t.randomDraw(i.left+i.width-i.left-s.width,i.left)),r.forEach(function(t){t.source=t.source.substring(0,s.text.length)===s.text?s.text:t.source,t.target=t.target.substring(0,s.text.length)===s.text?s.text:t.target,t.id=t.id.substring(0,t.source.length+t.target.length)})}return n},t.size=function(t){return t=util.d3v4()?t:t[0][0],t="Array"===util.varType(t)||"Object"===util.varType(t)?t:d3.select(t),{w:parseFloat(t.attr("width")),h:parseFloat(t.attr("height"))}},t}(draw||{}),eventHandler=function(t){"use strict";function e(t){function e(e){t({x:e.pageX-n.ctx.canvas.offsetLeft,y:e.pageY-n.ctx.canvas.offsetTop})}if(!n.ctx)throw new Error("Not found context of canvas.");n.ctx.canvas.removeEventListener("mousemove",e),n.ctx.canvas.addEventListener("mousemove",e)}var n={};return t.context=function(e){return n.ctx=e,arguments.length?t:n.ctx},t.data=function(e){return n.data=e,arguments.length?t:n.data},t.hover=function(t){e(function(t){})},t.onScroll=function(t,e){(t="object"==typeof t?t:document.querySelector(t)).addEventListener("scroll",e)},t}(eventHandler||{}),exclusive=function(){"use strict";function t(){var t={};return util.loop(s.data.survival.data[s.nowSet],function(e,n){e&&(n<=s.data.divisionIdx[s.nowSet].idx?t[e.participant_id]="altered":t[e.participant_id]="unaltered")}),t}function e(){var e=document.querySelector("#exclusivity_survival"),n=parseFloat(e.style.width),i=parseFloat(e.style.height)/1.5;SurvivalCurveBroilerPlate.settings={canvas_width:n,canvas_height:i,chart_width:n-30,chart_height:i-30,chart_left:50,chart_top:15,include_info_table:!1,include_legend:!0,include_pvalue:!0,pval_x:n-200,pval_y:42},SurvivalCurveBroilerPlate.style={censored_sign_size:5,axis_stroke_width:1,axisX_title_pos_x:n/2,axisX_title_pos_y:i-25,axisY_title_pos_x:-n/2+25,axisY_title_pos_y:10,axis_color:"black",pval_font_size:14,pval_font_style:"normal"},survival({element:"#exclusivity_survival",margin:[20,20,20,20],data:s.data.survival.data[s.nowSet],divisionData:t()})}function n(){network({data:s.data.network[s.nowSet],element:"#exclusivity_network"})}function i(){layout.getSVG(s.svg,["heatmap"],function(t,e){axis.element(e).left({margin:[35,0,35,e.attr("width")-80],data:s.nowSet.split(" "),opt:{remove:"line, path"}}).attr("id","exclusivity_heatmap_axis")})}function a(){layout.getSVG(s.svg,["heatmap"],function(t,e){heatmap({element:e,data:s.data.heatmap[s.nowSet],opt:config.exclusivity.heatmap.opt,attr:config.exclusivity.heatmap.attr,style:config.exclusivity.heatmap.style,margin:config.exclusivity.heatmap.margin,xaxis:s.data.axis.heatmap.x[s.nowSet],yaxis:s.data.axis.heatmap.y[s.nowSet]})})}function r(){layout.getSVG(s.svg,["heatmap"],function(t,e){divisionLine({element:e,height:45,direction:"h",color:["#FF6252","#00AC52"],attr:config.exclusivity.division.attr,style:config.exclusivity.division.style,text:["Altered group","Unaltered group"],margin:config.exclusivity.division.margin,axis:s.data.axis.heatmap.x[s.nowSet],point:""+s.data.divisionIdx[s.nowSet].idx,dashed:config.exclusivity.division.dashed})})}function o(){layout.getSVG(s.svg,["legend"],function(t,e){legend({element:e,data:s.data.type[s.nowSet],priority:config.exclusivity.priority,text:config.exclusivity.legend.text,attr:config.exclusivity.legend.attr,style:config.exclusivity.legend.style,margin:config.exclusivity.legend.margin})})}function l(){e(),n(),i(),a(),r(),o()}var s={};return function(t){console.log("Given Exclusivity data: ",t);var e=document.querySelector(t.element||null),n=parseFloat(t.width||e.style.width||1400),i=parseFloat(t.height||e.style.height||700);e.style.background="#F7F7F7",s.origin=t.data,s.data=preprocessing.exclusivity(t.data),s.ids=size.chart.exclusivity(e,n,i),s.svg=layout.exclusivity(s.ids,s),s.nowSet=s.data.geneset[0].join(" "),selectBox({element:"#exclusivity_select_geneset",initText:s.nowSet,className:"exclusivity-geneset",viewName:"geneset",items:s.data.geneset.map(function(t){return t.join(" ")}),click:function(t){s.nowSet=t.toUpperCase(),layout.removeG(),l()}}),l(),console.log("Exclusivity Model data: ",s)}}(),expression=function(t){"use strict";var e={};return function(t){var n=document.querySelector(t.element||null),i=parseFloat(t.width||n.style.width||1400),a=parseFloat(t.height||n.style.height||700);n.style.background="#F7F7F7",e.origin=t.data,e.data=preprocessing.expression(t.data),e.ids=size.chart.expression(n,i,a),e.svg=layout.expression(e.ids,e),console.log("Expression Model data: ",e)}}(),heatmap=function(t){"use strict";function e(t){util.loop(t,function(t,e){util.loop(i.mt,function(t,n){e[t][0]&&i.d.push({x:e.x,y:e.y,value:e[t][0]})})})}function n(t){return util.loop(t,function(t,e){var n=t.x+t.y,a=config.landscape.case(t.value);i.v[n]?config.landscape.priority(i.v[n][a][0])>config.landscape.priority(t.value)?i.v[n][a].unshift(t.value):i.v[n][a].push(t.value):(i.v[n]={cnv:[],var:[],x:t.x,y:t.y},i.v[n][a].push(t.value))}),e(i.v)}var i={mt:["cnv","var"],v:{},d:[]};return function(t){return i={mt:["cnv","var"],v:{},d:[]},i.e=t.element="Object"===util.varType(t.element)||"Array"===util.varType(t.element)?t.element:/\W/.test(t.element[0])?d3.select(t.element):d3.select("#"+t.element),i.s=draw.size(i.e),i.m=size.setMargin(t.margin),i.t=i.m.top||0,i.l=i.m.left||0,i.g=render.addGroup(i.e,i.t,i.l),i.sx=scale.get(t.xaxis,[i.m.left,(t.width||i.s.w)-i.m.right]),i.sy=scale.get(t.yaxis,[i.m.top,(t.height||i.s.h)-i.m.bottom]),render.rect({element:i.g.selectAll("#"+i.e.attr("id")+"_rect"),data:t.dup?(n(t.data),i.d):t.data,attr:{id:function(t){return i.e.attr("id")+"_rect"},x:function(e){return t.attr.x.call(i,e)},y:function(e){return t.attr.y.call(i,e)},width:function(e){return t.attr.width.call(i,e)},height:function(e){return t.attr.height.call(i,e)}},style:{fill:function(e){return t.style.fill(e)},stroke:function(e){return t.style.stroke(e)}}}),i}}(),landscape=function(t){"use strict";function e(){S.div.title=document.querySelector("#landscape_title"),S.div.title.innerHTML=S.origin.title}function n(t,e,n){var i=document.createElement("div");S.ids.push((i.id=t.id+"_"+e,i.id)),util.loop(n,function(t,e){i.style[t]=e}),t.appendChild(i)}function i(t){var e={_patient:document.getElementById("landscape_patient_group"),_axis:document.getElementById("landscape_axis_group"),_chart:document.getElementById("landscape_group")};util.loop(e,function(e,i){util.loop(t,function(a,r){n(i,util.removeWhiteSpace(a[0])+e,{width:draw.width(i)+"px",height:draw.height(i)/t.length+"px",overflowX:"hidden",overflowY:"hidden"})})})}function a(t,e,n,i){var a=!1;util.loop(t.split("_"),function(t,r){config.landscape[e][t]&&(a||(a=!0,i(config.landscape[e][t],n[t])))})}function r(t,e){return a(t,"axis",S.data.axis,e)}function o(t,e){return a(t,"bar",S.data,e)}function l(t,e){return a(t,"stack",S.data.stack,e)}function s(t,e){return a(t,"heatmap",S.data,e)}function c(t,e){return a(t,"group",S.data.group,e)}function u(t,e){var n;return t.indexOf("group")<0?e:(t.split("_").forEach(function(t){util.loop(e,function(e,i){t===e[0].replace(/\s/gi,"")&&(n=e)})}),n)}function d(t,e){var n;return util.loop(e,function(e,i){var a=(e.y||e[0].y).replace(/\s/gi,"");t.indexOf(a)>-1&&(n="Array"===util.varType(e)?e:[e])}),n}function p(){layout.getSVG(S.svg,["axis_sample","gene","pq","axis_group_"],function(t,e){r(t,function(t,n){t="Array"!==util.varType(t)?[t]:t,util.loop(t,function(t,i){axis.element(e)[t.direction]({margin:t.margin,data:u(e.attr("id"),"top"===t.direction||"bottom"===t.direction?n.x:n.y),opt:t.opt})})})})}function f(t,e,n,i){bar({data:e,opt:t.opt,element:n,attr:t.attr,style:t.style,margin:t.margin,direction:t.direction,width:i.indexOf("patient")<0&&i.indexOf("sample")>-1?S.now.width||S.init.width:null,xaxis:t.xaxis.call(S.data.axis),yaxis:t.yaxis.call(S.data.axis)})}function h(){layout.getSVG(S.svg,["pq"],function(t,e){o(t,function(n,i){f(n,i,e,t)})})}function g(){layout.getSVG(S.svg,["e_sample","patient_sample","gene"],function(t,e){l(t,function(n,i){f(n,i,e,t)})})}function m(){layout.getSVG(S.svg,["_heatmap"],function(t,e){s(t,function(n,i){heatmap({data:i,dup:!0,opt:n.opt,element:e,attr:n.attr,style:n.style,margin:n.margin,xaxis:n.xaxis.call(S.data.axis),yaxis:n.yaxis.call(S.data.axis),width:t.indexOf("patient")<0?S.now.width||S.init.width:null})})})}function x(){layout.getSVG(S.svg,["t_group_","e_group_"],function(t,e){c(t,function(n,i){heatmap({element:e,opt:n.opt,attr:n.attr,style:n.style,margin:n.margin,data:d(t,i),width:t.indexOf("patient")<0?S.now.width||S.init.width:null,xaxis:n.xaxis.call(S.data.axis),yaxis:S.data.axis.group.y.filter(function(e,n){if(t.indexOf(e[0].replace(/\s/gi,""))>-1)return e})[0]})})})}function y(){layout.getSVG(S.svg,["legend"],function(t,e){legend({element:e,data:S.data.type,priority:config.landscape.priority,text:config.landscape.legend.text,attr:config.landscape.legend.attr,style:config.landscape.legend.style,margin:[e.attr("height")/3,20,0,0]})})}function v(){S.init.width=2*draw.width(d3.select("#landscape_heatmap").node()),S.init.height=draw.height(d3.select("#landscape_heatmap").node())}function w(){landscapeScaleOption.set({element:"#landscape_option",default:100,defaultValue:S.init.width,interval:10,unit:"%",btn:[{id:"upscale",className:"upscale"},{id:"downscale",className:"downscale"},{id:"initialize",className:"initialize"}],input:{id:"viewscale",className:"viewscale"},change:function(t,e){return layout.removeG(),"initialize"===t?(_({axis:"x",data:S.init.axis.x}),_({axis:"y",data:S.init.axis.y}),k(S.data,(S.now.width=S.init.width,S.now.width))):k(S.data,(S.now.width=e,S.now.width))}})}function _(t){"x"===t.axis?(S.data.axis.group[t.axis]=t.data,S.data.axis.sample[t.axis]=t.data,S.data.axis.heatmap[t.axis]=t.data):(S.data.axis.pq[t.axis]=t.data,S.data.axis.gene[t.axis]=t.data,S.data.axis.heatmap[t.axis]=t.data)}function b(){selectBox({element:"#landscape_option",margin:[0,8,0,0],height:"30px",className:"landscape-sort",initText:"Select by sort..",viewName:"sort",items:["Mutation","Value","Sample"],click:function(t){S.now.sort[t]&&"asc"===S.now.sort[t]?S.now.sort[t]="desc":S.now.sort[t]="asc",layout.removeG(),_(landscapeSort[S.now.sort[t]](t,S.data)),k(S.data,S.now.width)}})}function F(t){layout.getSVG(S.svg,["e_group_","e_sample","e_heatmap"],function(e,n){n.attr("width",t||S.now.width||S.init.width)})}function k(t,e){F(e),p(),g(),h(),m(),x(),y()}var S={div:{},init:{axis:{x:[],y:[]},width:0,height:0},now:{sort:{mutation:null,sample:null,value:null},axis:{x:[],y:[]},width:0,height:0},exclusive:{init:null}};return function(t){console.log("Given Landscape data: ",t);var n=document.querySelector(t.element||null),a=parseFloat(t.width||n.style.width||1400),r=parseFloat(t.height||n.style.height||700);S.origin=t.data,S.data=preprocessing.landscape(t.data),S.init.axis.x=(new Array).concat(S.data.axis.heatmap.x),S.init.axis.y=(new Array).concat(S.data.axis.gene.y),S.ids=size.chart.landscape(n,a,r),v(),e(),w(),b(),i(S.data.axis.group.y),S.svg=layout.landscape(S.ids,S),S.exclusive.init=landscapeSort.exclusive(S.data.heatmap,S.data.gene),_(S.exclusive.init),k(S.data,S.init.width),console.log("Landscape Model data: ",S),eventHandler.onScroll("#landscape_heatmap",function(t){var e=document.querySelector("#landscape_sample"),n=document.querySelector("#landscape_group").children,i=Array.prototype.slice.call(n);e.scrollLeft=this.scrollLeft,util.loop.call(this,i,function(t,e){t.scrollLeft=this.scrollLeft})})}}(),landscapeScaleOption=function(t){"use strict";function e(t){return{upscale:"fa fa-caret-up",downscale:"fa fa-caret-down",initialize:"fa fa-refresh"}[t]}function n(t){var e=document.querySelector("#viewscale");switch(this.id){case"upscale":r.status+=r.interval;break;case"downscale":r.status-=r.interval;break;case"initialize":r.status=r.default;break;default:return}var n="upscale"===this.id?1:-1,i=parseInt(.1*r.defaultValue);r.status=r.status<r.default?r.default:r.status>200?200:r.status,e.value=r.status+" %",r.nowValue="initialize"===this.id?r.defaultValue:(this.id,r.nowValue+n*i),r.nowValue=r.defaultValue>r.nowValue?r.defaultValue:2*r.defaultValue<r.nowValue?2*r.defaultValue:r.nowValue,!!r.change&&r.change(this.id,r.nowValue)}function i(t,i){for(var a=0,r=i.btn.length;a<r;a++){var o=i.btn[a],l=document.createElement("button"),s=document.createElement("i");s.className=e(o.id),l.id=o.id,l.addEventListener("click",n),l.appendChild(s),t.appendChild(l)}}function a(t,e){util.loop(e.input,function(e,n){var i=document.createElement("input");i.id=e.id,i.readOnly=!0,i.tabIndex=-1,i.value=(r.value||r.default)+" "+r.unit,t.appendChild(i)})}var r={};return t.set=function(e){if(d3.select(".scale-option-frame").empty()){var n=document.createElement("div");n.className="scale-option-frame",(r=e).status=e.default,r.e=document.querySelector(e.element),r.width=parseFloat(e.width||r.e.style.width||140),r.height=parseFloat(e.height||r.e.style.height||105),r.change=e.change||null,r.defaultValue=e.defaultValue,r.nowValue=r.defaultValue,r.e.appendChild(n),e.btn=e.btn.length?e.btn:[e.btn],e.input=e.input.length?e.input:[e.input],a(n,e),i(n,e)}return t},t.change=function(e){return e(r),t},t}(landscapeScaleOption||{}),landscapeSort=function(t){"use strict";function e(t,e){switch(t){case"mutation":return e.stack.gene;case"sample":return e.stack.sample;case"value":return e.pq;case"init":return e.init;default:throw new Error("No matching any data")}}function n(t,e){var n={};return util.loop(t,function(t,i){n[t[e]]=n[t[e]]?n[t[e]]+=t.value:n[t[e]]=t.value}),n}function i(t){var e=[];return util.loop(t,function(t,n){e.push({key:t,value:n})}),e}function a(t,e){var n="asc"===t?1:-1;return e.sort(function(t,e){return t.value>e.value?1*n:-1*n})}function r(t,e){return{axis:"y",data:a(t,i(n(e,"y"))).map(function(t){return t.key})}}function o(t,e){return{axis:"x",data:a(t,i(n(e,"x"))).map(function(t){return t.key})}}function l(t,e){return{axis:"y",data:a(t,e).map(function(t){return t.y})}}function s(t,e,n){switch(t){case"mutation":return r(e,n);case"sample":return o(e,n);case"value":return l(e,n);default:throw new Error("Not matching any function")}}function c(t,e,n){var i=2*e.indexOf(n.y),a="cnv"===config.landscape.case(n.value)?0:1;t.value=t.value.replaceAt(i,"00".replaceAt(a,"1"))}function u(t){for(var e="",n=0;n<t;n++)e+="00";return e}function d(t){return{axis:"x",data:t.sort(function(t,e){return t.value<e.value?1:-1}).map(function(t,e){return t.key})}}var p={exclusive:[]};return t.exclusive=function(t,e){var n={},i=[],a=0;return util.loop(t,function(t){n[t.x]?n[t.x]=n[t.x]:(n[t.x]=!0,i.push({key:t.x,value:u(e.length)}),a+=1),c(i[a-1],e,t)}),p.exclusive=i,d(i)},t.asc=function(t,n){return s(t,"asc",e(t,n))},t.desc=function(t,n){return s(t,"desc",e(t,n))},t.byGene=function(){},t.byGroup=function(){},t}(landscapeSort||{}),layout=function(t){"use strict";function e(t,e,i){return util.loop(i,function(i,a){var r=!0;util.loop(t,function(t,e){i.indexOf(t)>-1&&(r=!r)}),r&&(n[e][i]=render.createSVG(i))}),n[e]}var n={exclusivity:{},expression:{},landscape:{},variants:{}};return t.getSVG=function(t,e,n){util.loop(t,function(t,i){util.loop(e,function(e,a){if(t.indexOf(e)>-1)return n(t,i)})})},t.removeG=function(){d3.selectAll("svg .g-tag").remove()},t.exclusivity=function(t){return e(["geneset","survival","network"],"exclusivity",t)},t.landscape=function(t){return e(["option","title"],"landscape",t)},t.variants=function(t){return e(["title"],"variants",t)},t.expression=function(t){return e(["title"],"expression",t)},t}(layout||{}),legend=function(t){"use strict";function e(t,e){var n=0;return util.loop(t,function(t,i){n=n>draw.getTextWidth(t,e)?n:draw.getTextWidth(t,e)}),n}var n={};return function(t){(n={}).d=t.data.sort(function(e,n){return t.priority(e)>t.priority(n)?1:-1}),n.e=t.element="Object"===util.varType(t.element)||"Array"===util.varType(t.element)?t.element:/\W/.test(t.element[0])?d3.select(t.element):d3.select("#"+t.element),n.m=size.setMargin(t.margin),n.w=n.e.attr("width"),n.h=n.e.attr("height"),n.t=n.m.top||0,n.l=n.m.left||0,n.p=t.padding||5,n.sw=n.sg=render.addGroup(n.e,n.t,n.l),n.tg=render.addGroup(n.e,n.t,n.l),n.mw=e(n.d,"10px Arial"),n.mh=draw.getTextHeight("10px Arial").height,n.dr=n.w-n.m.left-n.m.right>n.h-n.m.top-n.m.bottom?"h":"v";var i=n.e.attr("id");t.attr.r?render.circle({element:n.sg.selectAll("#"+i+"_circle"),data:n.d,attr:{id:function(t){return i+"_circle"},cx:function(e,i){return t.attr.x?t.attr.x.call(n,e,i):0},cy:function(e,i){return t.attr.y?t.attr.y.call(n,e,i):0},r:function(e,i){return t.attr.r?t.attr.r.call(n,e,i):0}},style:{fill:function(e){return t.style.fill?t.style.fill(e):"#000000"},stroke:function(e){return!!t.style.stroke&&t.style.stroke(e)}}}):t.attr.points?render.triangle({element:n.sg.selectAll("#"+i+"_triangle"),data:n.d,attr:{id:function(t){return i+"_triangle"},points:function(e,i){return t.attr.points?t.attr.points.call(n,e,i):[0,0]}},style:{fill:function(e){return t.style.fill?t.style.fill(e):"#000000"},stroke:function(e){return!!t.style.stroke&&t.style.stroke(e)},"stroke-width":function(e){return t.style.strokeWidth?t.style.strokeWidth(e):"1px"}}}):render.rect({element:n.sg.selectAll("#"+i+"_rect"),data:n.d,attr:{id:function(t){return i+"_rect"},x:function(e,i){return t.attr.x?t.attr.x.call(n,e,i):0},y:function(e,i){return t.attr.y?t.attr.y.call(n,e,i):0},width:function(e,i){return t.attr.width?t.attr.width.call(n,e,i):5},height:function(e,i){return t.attr.height?t.attr.height.call(n,e,i):5}},style:{fill:function(e){return t.style.fill?t.style.fill(e):"#000000"},stroke:function(e){return!!t.style.stroke&&t.style.stroke(e)}}}),render.text({element:n.tg.selectAll("#"+n.e.attr("id")+"_text"),data:n.d,attr:{id:function(t){return n.isText=!0,n.e.attr("id")+"_text"},x:function(e,i){return t.attr.x?t.attr.x.call(n,e,i):0},y:function(e,i){return t.attr.y?t.attr.y.call(n,e,i):0}},style:{"font-size":function(e){return t.style.fontSize?t.style.fontSize(e):"10px"},"font-family":function(e){return t.style.fontFamily?t.style.fontFamily(e):"Arial"},"alignment-baseline":function(e){return t.style.alignmentBaseline?t.style.alignmentBaseline:"middel"}},text:function(e,i){return t.text(e,i,n)||"legend"+i}})}}();!function(t){"use strict";t.bio={draw:draw,config:config,render:render,variants:variants,pathways:"",expression:expression,landscape:landscape,exclusive:exclusive,chart:{bar:bar,legend:legend,needle:needle,needleGraph:needleGraph,needleNavi:needleNavi,network:network,heatmap:heatmap,survival:survival},tools:{selectBox:selectBox,divisionLine:divisionLine,selectGeneSet:selectGeneSet,landscapeSort:landscapeSort,landscapeScaleOption:landscapeScaleOption},util:util,size:size,scale:scale,layout:layout,eventHandler:eventHandler,preprocessing:preprocessing}}(window||{});var needle=function(t){"use strict";var e={};return function(t){(e={}).e=t.element="Object"===util.varType(t.element)||"Array"===util.varType(t.element)?t.element:/\W/.test(t.element[0])?d3.select(t.element):d3.select("#"+t.element),e.s=draw.size(e.e),e.m=size.setMargin(t.margin),e.t=e.m.top||0,e.l=e.m.left||0,e.g=render.addGroup(e.e,e.m.top,e.m.left),e.xag=render.addGroup(e.e,e.m.top,e.m.left),e.xxg=render.addGroup(e.e,e.m.top,e.m.left),e.radius=t.radius||5,e.sx=scale.get(t.xaxis,[e.m.left,e.s.w-e.m.right]),e.sy=scale.get(t.yaxis,[e.s.h-e.m.bottom,e.m.top]),e.line=(util.d3v4()?d3.line():d3.svg.line()).x(function(t){return e.sx(t.x)}).y(function(t){return e.sy(t.y)}),util.loop(t.lineData,function(t,n){render.line({element:e.g,attr:{id:function(t){return e.e.attr("id")+"_line"},d:e.line(t.value)},style:{stroke:"#333333"}})}),render.circle({element:e.g.selectAll("#"+e.e.attr("id")+"_circle"),data:t.circleData,attr:{id:function(t){return e.e.attr("id")+"_circle"},cx:function(n,i){return t.attr.x?t.attr.x.call(e,n,i):0},cy:function(n,i){return t.attr.y?t.attr.y.call(e,n,i):0},r:function(n,i){return t.attr.r?t.attr.r.call(e,n,i):e.radius}},style:{fill:function(n,i){return t.style.fill?t.style.fill.call(e,n,i):"#000000"},stroke:function(n,i){return t.style.stroke?t.style.stroke.call(e,n,i):"#FFFFFF"}}})}}(),needleGraph=function(t){"use strict";function e(){for(var t=1;draw.getTextHeight(t+"px").height<n.sh/2;)t+=1;return t+"px"}var n={};return function(t){(n={}).e=t.element="Object"===util.varType(t.element)||"Array"===util.varType(t.element)?t.element:/\W/.test(t.element[0])?d3.select(t.element):d3.select("#"+t.element),n.s=draw.size(n.e),n.m=size.setMargin(t.margin),n.t=n.s.h-n.m.bottom,n.l=n.m.left||0,n.g=render.addGroup(n.e,n.t,n.l),n.sx=scale.get(t.xaxis,[n.m.left,n.s.w-n.m.right]),n.sy=scale.get(t.yaxis,[n.s.h-n.m.bottom,n.m.top]),n.sh=Math.abs(n.sy(1)-n.sy(0))/2,n.mfh=e(),render.rect({element:n.g.selectAll("#"+n.e.attr("id")+"_base"),data:[""],attr:{id:n.e.attr("id")+"_base",x:n.sx(util.minmax(t.xaxis).min)+5,y:.1*n.sh,width:n.s.w-n.m.right-n.m.left-5,height:.8*n.sh,rx:1,ry:1},style:{fill:"#DADFE1",stroke:"#CCCDCE","stroke-width":"5px"}}),render.rect({element:n.g.selectAll("#"+n.e.attr("id")+"_rect"),data:t.data,attr:{id:function(t){return n.e.attr("id")+"_rect"},x:function(e,i){return t.attr.x?t.attr.x.call(n,e,i):0},y:function(e,i){return t.attr.y?t.attr.y.call(n,e,i):0},width:function(e,i){return t.attr.width?t.attr.width.call(n,e,i):0},height:function(e,i){return t.attr.height?t.attr.height.call(n,e,i):0},rx:3,ry:3},style:{fill:function(e,i){return t.style.fill?t.style.fill.call(n,e,i):"#000000"},stroke:function(e,i){return t.style.stroke?t.style.stroke.call(n,e,i):"#FFFFFF"}}}),render.text({element:n.g.selectAll("#"+n.e.attr("id")+"_text"),data:t.data,attr:{id:function(t){return n.isText=!0,n.e.attr("id")+"_text"},x:function(e,i){return t.attr.x?t.attr.x.call(n,e,i):0},y:function(e,i){return t.attr.y?t.attr.y.call(n,e,i):0}},style:{fill:"#FFFFFF","font-size":n.mfh,"alignment-baseline":"middle"},text:function(e,i){return t.text?t.text.call(n,e,i):0}})}}(),needleNavi=function(t){"use strict";function e(t){util.loop(t,function(t,e){render.rect({element:n.g.selectAll("#"+n.e.attr("id")+"_"+t),data:[t],attr:{id:function(t){return n.e.attr("id")+"_"+t},x:"end"===t?n.end+n.m.left-5:n.start-5,y:.25*n.s.h,width:10,height:.4*n.s.h,rx:5,rx:5},style:{fill:"#A8A8A8",stroke:"#EAECED","stroke-width":"2px",cursor:"move"}})})}var n={start:0,end:0};return function(t){(n={}).e=t.element="Object"===util.varType(t.element)||"Array"===util.varType(t.element)?t.element:/\W/.test(t.element[0])?d3.select(t.element):d3.select("#"+t.element),n.s=draw.size(n.e),n.m=size.setMargin(t.margin),n.t=n.m.top||0,n.l=n.m.left||0,n.g=render.addGroup(n.e,n.m.top,n.m.left),n.sx=scale.get(t.xaxis,[n.m.left,n.s.w-n.m.right]),n.sy=scale.get(t.yaxis,[n.s.h-n.m.bottom,n.m.top]),n.start=n.sx(util.minmax(t.xaxis).min),n.end=n.s.w-n.m.right-n.m.left,needle({element:n.e,lineData:t.data.needle,circleData:t.data.fullNeedle,attr:config.variants.needle.attr,style:t.style,margin:[5,30,10,60],xaxis:t.xaxis,yaxis:t.yaxis}),render.rect({element:n.g.selectAll("#"+n.e.attr("id")+"_navi"),data:[""],attr:{id:function(t){return n.e.attr("id")+"navi"},x:n.start,y:0,width:n.end,height:n.s.h-n.m.bottom,rx:3,ry:3},style:{fill:"rgba(255, 225, 50, 0.1)",stroke:"#FFDF6D"}}),e(["start","end"])}}(),network=function(){"use strict";return function(t){var e=[],n={},i="";t.data.map(function(t){if("compound"===t.type)i=t.members,e.push({group:"nodes",data:{id:"n0",bgcolor:t.bgcolor,bdcolor:t.bordercolor||"rgb(0, 0, 0)",width:100,height:150,isComp:!0,per:t.text},position:{}});else if("node"===t.type){var a={data:{id:i.indexOf(t.text)>-1?"n0:"+t.text:t.text,name:t.text,bgcolor:t.bgcolor,bdcolor:t.bordercolor||"rgb(0, 0, 0)",width:draw.getTextWidth(t.text,"14px Calibri"),height:20,fontSize:10,isComp:!1},group:"nodes"};n[t.text]={parent:i.indexOf(t.text)>-1?"n0:":""},i.indexOf(t.text)>-1&&(a.data.parent="n0"),e.push(a)}else if("edge"===t.type){var r="",o="",l="";for(var s in n)t.source.substring(0,s.length)===s&&(r=n[s].parent+s,l=t.source.substring(s.length,t.source.length),o=n[t.target.substring(0,t.target.indexOf(l))].parent+t.target.substring(0,t.target.indexOf(l)));e.push({data:{id:r+o,source:r,target:o,color:t.linecolor},group:"edges"})}}),cytoscape({container:document.querySelector(t.element),boxSelectionEnabled:!1,autoungrabify:!0,autounselectify:!0,pixelRatio:"auto",elements:e,style:cytoscape.stylesheet().selector("node").css({shape:"rectangle",width:"data(width)",height:"data(height)","font-size":"10",content:"data(name)","text-valign":"center","background-color":"data(bgcolor)","border-color":"data(bdcolor)","border-width":"1"}).selector(":parent").css({"background-color":"rgba(255, 255, 255, 0.5)","border-color":"rgb(150, 0, 0)","border-width":"1",content:"data(per)","font-size":"10","text-valign":"top"}).selector("edge").css({"curve-style":"bezier","target-arrow-shape":"triangle","target-arrow-color":"data(color)","arrow-scale":"1","line-color":"data(color)"}),layout:{name:"cose-bilkent",animate:!1}}).resize(550,10,10,10)}}(),preprocessing=function(t){"use strict";function e(t){util.loop(t,function(t,e){var n=0,i={key:t,value:[{x:parseFloat(t),y:n,value:0}]};L.axis.needle.y.push(n),util.loop(e,function(e,a){i.value.push({x:parseFloat(t),y:n+=a.length,value:a.length,info:a})}),L.axis.needle.y.push(n),L.needle.push(i)})}function n(t){var n={};util.loop(t,function(t,e){t.type=config.landscape.name(t.type);var i=t.position+" "+t.type+" "+t.aachange;n[t.position]?n[t.position][i]?n[t.position][i].push(t):n[t.position][i]=[t]:(n[t.position]={},n[t.position][i]=[t]),L.type.indexOf(t.type)<0&&L.type.push(t.type)}),e(n)}function i(){util.loop(L.needle,function(t,e){util.loop(t.value,function(e,n){e.info&&(e.value=e.y-t.value[n-1].y,L.fullNeedle.push(e))})})}function a(t){util.loop(t,function(t,e){L.graph.push({x:t.start,y:0,width:t.end-t.start,height:15,color:t.colour,info:t})})}function r(t){L.axis.needle.x=[0,t[0].length],L.axis.needle.y=L.axis.needle.y.length<1?[0,1]:[util.minmax(L.axis.needle.y).min,util.minmax(L.axis.needle.y).max]}function o(t){return/[\[][\w(\s|,)]+[\]]/.exec(t)[0].replace(/\[|\]/g,"").split(" ")}function l(t){return"rgb("+t.split(" ").join(",")+")"}function s(t){var e=[];return util.loop(t,function(t,n){var i={};util.loop(t.split("\t"),function(t,e){i[t.split(":")[0]]=t.split(":")[0].indexOf("color")<0?t.split(":")[1]:l(t.split(":")[1])}),e.push(i)}),e}function c(t){util.loop(t,function(t,e){V.network[t]=s(e)})}function u(t){var e={};util.loop(t.split("\n"),function(t,n){util.loop(V.geneset,function(n,i){t.indexOf(n.join(""))>-1&&(e[n.join(" ")]?e[n.join(" ")].push(t):e[n.join(" ")]=[t])})}),c(e)}function d(t){return V.type[t.join(" ")]=[]}function p(t,e,n,i,a,r,o){util.loop(e.split(""),function(e,l){a.push(""+l),r.push(""+l),util.loop(config.exclusivity.separate(e),function(e,a){e=config.exclusivity.name(e),n.push({x:l,y:t,value:e}),i.indexOf(e)<0?i.push(e):i=i}),o.idx="."!==e?o.idx>l?o.idx:l:o.idx})}function f(t,e,n){var i=d(e);util.loop(t,function(t,a){util.loop(e,function(a,r){if(t.indexOf(a)>-1){var o=e.join(" ");V.axis.heatmap.x[o]=[],V.axis.heatmap.y[o]=e,V.axis.division.x[o]=[],V.divisionIdx[o]={idx:0},p(a,t.substring(0,t.indexOf(" ")),n,i,V.axis.heatmap.x[o],V.axis.division.x[o],V.divisionIdx[o])}})})}function h(t){util.loop(t.split("\n\n"),function(t,e){if(""!==t){var n=o(t),i=t.split("\n"),a=i.splice(1,i.length);f(a,n,V.heatmap[n.join(" ")]=[]);V.survival.heat[n.join(" ")]=a,V.fullGeneset.concat(n),V.geneset.push(n)}})}function g(t){var e={};return util.loop(t,function(t,n){e[t.gene]=["."]}),e}function m(t,e){var n={};return util.loop(t,function(t,i){var a=config.landscape.name(t.type),r="Amplification"===a||"Homozygous_deletion"===a?"Amplification"===a?"A":"D":"M",o=util.cloneObject(e);n[t.participant_id]?"."===n[t.participant_id][t.gene][0]?n[t.participant_id][t.gene]=[r]:n[t.participant_id][t.gene].push(r):(o[t.gene]=[r],n[t.participant_id]=o)}),n}function x(t,e){var n=g(e),i=m(e,n);util.loop(t,function(t,e){t.gene=i[t.participant_id]?i[t.participant_id]:n}),V.survival.merge=t}function y(t){return t.indexOf("A")>-1&&t.indexOf("M")>-1?"B":t.indexOf("D")>-1&&t.indexOf("M")>-1?"E":t[0]}function v(t){var e={};util.loop(V.survival.heat,function(t,n){for(var i=V.axis.heatmap.x[t].length,a=t.split(" "),r=V.survival.data[t]?V.survival.data[t]:V.survival.data[t]=[],o=e[t]={},l=0;l<i;l++)V.survival.merge.some(function(t){for(var e=!0,i=0;i<a.length;i++)y(t.gene[a[i]])!==n[i][l]&&(e=!1);if(e&&void 0===o[t.participant_id])return o[t.participant_id]="",r[l]=t,void 0!==r[l]})})}function w(t){q.type[t]||(q.type[t]=null)}function _(t){t[q.keys.t]=j.name(t[q.keys.t])}function b(t,e,n,i,a){return"gene"===t?{x:e,y:n,value:i,info:a}:{x:n,y:e,value:i,info:a}}function F(t,e){var n=[];return util.loop(e,function(e,i){var a=0,r=0;util.loop(i,function(i,o){n.push(b(t,a,e,o,i)),a+=o,r+=o}),q.axis[t]["gene"===t?"x":"y"].push(r)}),n}function k(t,e,n){t[e]=t[e]?t[e]:{},t[e][n]=t[e][n]?t[e][n]+1:1}function S(t,e){t.push({x:e[q.keys.p],y:e[q.keys.g],value:e[q.keys.t]})}function A(t,e){util.loop(t,function(t,n){_(t),w(t[q.keys.t]),e(t,n)})}function C(t){A(t,function(t,e){k(q.stack.gene,t[q.keys.g],t[q.keys.t]),k(q.stack.sample,t[q.keys.p],t[q.keys.t]),S(q.heatmap,t),q.axis.sample.x.indexOf(t[q.keys.p])<0&&q.axis.sample.x.push(t[q.keys.p])})}function E(t){A(t,function(t,e){k(q.stack.patient,t[q.keys.p],t[q.keys.t]),S(q.patient,t),q.axis.patient.x.indexOf(t[q.keys.p])<0&&q.axis.patient.x.push(t[q.keys.p])})}function B(t){return Math.log(t)/Math.log(12)*-1}function D(t,e){var n=[];return util.loop(t,function(t,i){n.push({x:0,y:t[q.keys.g],value:B(t[e])})}),n}function T(t){util.loop(t,function(t,e){var n=[];util.loop(t.data,function(e,i){n.push({x:e[q.keys.p],y:t.name,value:e.value})}),q.group.group.push(n),q.axis.group.y.push([t.name]),q.group.patient.push({x:q.axis.patient.x[0],y:t.name,value:"NA"})})}function z(){q.axis.gene.x=[util.minmax(q.axis.gene.x).max,0],q.axis.sample.y=[util.minmax(q.axis.sample.y).max,0],q.axis.pq.x=[0,util.minmax(q.pq.map(function(t){return Math.ceil(t.value)})).max]}function G(){q.axis.pq.y=q.gene,q.axis.gene.y=q.gene,q.axis.heatmap.y=q.gene,q.axis.heatmap.x=q.axis.sample.x,q.axis.group.x=q.axis.sample.x}function O(t,e){var n={};return util.loop(e,function(e,i){t.indexOf(i)>-1?n.g=e:j.color(j.name(i))?n.t=e:n.p=e}),n}var M={expression:{heatmap:{},scatter:{},bar:{},survival:{}},exclusivity:{heatmap:{},network:{},type:{},survival:{merge:{},heat:{},data:{}},geneset:[],fullGeneset:[],axis:{heatmap:{x:{},y:{}},division:{x:{},y:[]}},divisionIdx:{}},landscape:{keys:{},type:{},group:{group:[],patient:[]},heatmap:[],patient:[],stack:{gene:{},sample:{},patient:{}},axis:{pq:{x:[],y:[]},gene:{x:[],y:[]},group:{x:[],y:[]},sample:{x:[],y:[]},heatmap:{x:[],y:[]},patient:{x:[],y:[]}}},variants:{needle:[],fullNeedle:[],type:[],graph:[],axis:{needle:{x:[],y:[]}}}},q=M.landscape,V=M.exclusivity,N=M.expression,L=M.variants,j=config.landscape;return t.variants=function(t){return n(t.variants.public_list),a(t.variants.graph),r(t.variants.graph),i(),L.patient=t.variants.patient_list.map(function(t,e){return t.type=config.landscape.name(t.type),t}),console.log("Preprocess of Variants: ",L),L},t.exclusivity=function(t){return x(t.survival.patient,t.survival.types),h(t.heatmap),u(t.network),v(t.heatmap),console.log("Preprocess of Exclusivity: ",V),V},t.landscape=function(t){return q.gene=t.gene,q.keys=O(q.gene,t.mutation.concat(t.patient)[0]),C(t.mutation),E(t.patient),T(t.group),q.type=util.keyToArr(q.type),q.pq=D(t.pq,t.pqValue||"p"),q.stack.gene=F("gene",q.stack.gene),q.stack.sample=F("sample",q.stack.sample),q.stack.patient=F("patient",q.stack.patient),z(),G(),console.log("Preprocess of Landscape: ",q),q},t.expression=function(t){return console.log(t),console.log("Preprocessing of Expression: ",N),N},t}(preprocessing||{}),render=function(t){"use strict";function e(t,e){for(var n in e)t.attr(n,e[n])}function n(t,e){for(var n in e)t.style(n,e[n])}function i(t,e){t.text(e)}function a(t){var a=this.element.data(this.data).enter().append(t);!!this.text&&i(a,this.text),e(a,this.attr),n(a,this.style)}return t.createSVG=function(t,e,n){var t=t.indexOf("#")<0?"#"+t:t,i=document.querySelector(t);return d3.select(t).append("svg").attr("id",t.replace("#","")+"_chart").attr("width",(e||parseFloat(i.style.width))+1).attr("height",n||parseFloat(i.style.height))},t.addGroup=function(t,e,n){return t=util.d3v4()?t:t[0][0],(t="Array"===util.varType(t)||"Object"===util.varType(t)?t:d3.select(t)).append("g").attr("class",t.attr("id")+" g-tag").attr("transform","translate("+n+", "+e+")")},t.rect=function(t){a.call(t,"rect")},t.circle=function(t){a.call(t,"circle")},t.text=function(t){a.call(t,"text")},t.line=function(t){var i=t.element.append("path");e(i,t.attr),n(i,t.style)},t.triangle=function(t){a.call(t,"polygon")},t}(render||{}),scale=function(t){"use strict";function e(t,e){var n=[];if("number"==typeof e[0]&&"number"==typeof e[1]){for(var a=Math.max(e[0],e[1]),r=Math.min(e[0],e[1]),o=a+r-r,l=r;l<=o;l++)n.push(l);return i.data.push(n),i.len.push(o),"ordinal"===t?n:[e[0],e[1]]}return i.data.push(e),i.len.push(e.length),e}function n(t){return"String"===util.varType(t[0])?"ordinal":"linear"}var i={data:[],len:[]};return t.ordinal=function(t,n){var i=e("ordinal",t);return d3.scaleBand?d3.scaleBand().domain(i).range(n):d3.scale.ordinal().domain(i).rangeBands(n)},t.linear=function(t,n){var i=e("linear",t);return d3.scaleLinear?d3.scaleLinear().domain(i).range(n):d3.scale.linear().domain(i).range(n)},t.getType=function(t){return"number"==typeof t[0]?"linear":"ordinal"},t.compatibleBand=function(t){return t.bandwidth?t.bandwidth():t.rangeBand()},t.getDomain=function(){return i.data.shift()},t.getDomainLength=function(){return i.len.shift()},t.getDistance=function(e){return"ordinal"===e?t.compatibleBand():t(1)-t(0)},t.get=function(e,i){return t[n(e)](e,i)},t}(scale||{}),selectBox=function(t){"use strict";function e(t){var e=document.createElement("div");return e.className=t+" drop-menu",e.style.width=o.w-2*o.m.left+"px",e.style.marginLeft=o.m.left+"px",e.style.height=o.h,e.style.fontSize="14px",e}function n(t,e){var n=document.createElement("div"),i=document.createElement("span"),a=document.createElement("i");return n.className=(t||"")+" select",i.innerHTML=e||"Select ...",a.className="fa fa-chevron-down",n.appendChild(i),n.appendChild(a),n}function i(t){var e=document.createElement("input");return e.type="hidden",e.name=t,e}function a(t){var e=document.createElement("ul");return e.className="dropeddown",console.log(t),util.loop(t,function(t){var n=document.createElement("li");n.id=t.toLowerCase(),n.innerHTML=t,e.appendChild(n)}),e}function r(t){$(".drop-menu").click(function(){$(this).attr("tabindex",1).focus(),$(this).toggleClass("active"),$(this).find(".dropeddown").slideToggle(300)}),$(".drop-menu").focusout(function(){$(this).removeClass("active"),$(this).find(".dropeddown").slideUp(300)}),$(".drop-menu .dropeddown li").click(function(){$(this).parents(".drop-menu").find("span").text($(this).text()),$(this).parents(".drop-menu").find("input").attr("value",$(this).attr("id")),t.call(this,$(this).text().toLowerCase())})}var o={};return function(t){o.e=document.querySelector(t.element),o.m=size.setMargin(t.margin||[0,0,0,0]),o.w=t.width||parseFloat(o.e.style.width),o.h=t.height||parseFloat(o.e.style.height);var l=e(t.className),s=n(t.className,t.initText),c=i(t.viewName||"Select ..."),u=a(t.items);l.appendChild(s),l.appendChild(c),l.appendChild(u),o.e.appendChild(l),r(t.click)}}(),selectGeneSet=function(t){"use strict";function e(){l.l=document.createElement("label")}function n(t){l.s=document.createElement("select"),l.s.id=t.replace("#","")+"_view",l.l.appendChild(l.s)}function i(t){util.loop(t,function(t,e){var n=document.createElement("option"),i=t.join(" ");n.text=i,n.value=i,l.s.options.add(n)})}function a(t){var e="";return util.loop(t,function(t,n){var i=t.join(" ");e=i.length>e.length?i:e}),e}function r(t,e,n){var i=1;for(a(t);draw.getTextHeight(i+"px").height<n/4.8;)i+=1;l.view.style.fontSize=i+"px"}function o(t){l.area=document.querySelector("#exclusivity_select_geneset"),l.view=document.querySelector("#exclusivity_select_geneset_view"),l.label=document.querySelector("#exclusivity_select_geneset label");var e=parseFloat(l.area.style.width),n=parseFloat(l.area.style.height);l.label.style.width=.8*e+"px",l.view.style.width=.8*e+"px",l.label.style.padding=.05*e+"px",l.label.style.marginTop=.03*e+"px",l.label.style.marginLeft=.03*e+"px",r(t,e,n)}var l={};return t.set=function(t){var a=document.querySelector(t.element);return e(),n(t.element),i(t.data),l.s.onchange=t.change||null,a.appendChild(l.l),o(t.data),l.s.value},t}(selectGeneSet||{}),size=function(t){"use strict";function e(t){util.loop.call(this,t,function(t,e){var i=document.createElement("div");i.id=t,i.style.width=e.w+"px",i.style.height=e.h+"px",n.ids.push(t),this.appendChild(i)})}var n={ids:[]};return t.chart={},t.setMargin=function(t){if(!t.length)return{top:t,left:t,bottom:t,right:t};if("[object Object]"===Object.prototype.toString.call(t))return t;switch(t.length){case 1:return{top:t[0],left:t[0],bottom:t[0],right:t[0]};case 2:return{top:t[0],left:t[1],bottom:t[0],right:t[1]};case 3:return{top:t[0],left:t[1],bottom:t[2],right:t[1]};case 4:default:return{top:t[0],left:t[1],bottom:t[2],right:t[3]}}},t.setSize=function(t,e,n){return t.style.width=e+"px",t.style.height=n+"px",t},t.chart.exclusivity=function(i,a,r){var o={exclusivity_select_geneset:{w:.25*a,h:.1*r},exclusivity_upper_empty:{w:.34*a,h:.2*r},exclusivity_survival:{w:.4*a,h:r},exclusivity_network:{w:.25*a,h:.55*r},exclusivity_heatmap:{w:.35*a,h:.3*r},exclusivity_legend:{w:.35*a,h:.1*r}};return e.call(t.setSize(i,a,r),o),n.ids},t.chart.landscape=function(i,a,r){var o={landscape_title:{w:a,h:.05*r},landscape_legend:{w:.15*a,h:r},landscape_axis_sample:{w:.15*a,h:.15*r},landscape_patient_sample:{w:.01*a,h:.15*r},landscape_sample:{w:.59*a,h:.15*r},landscape_scale_option:{w:.1*a,h:.15*r},landscape_axis_group:{w:.15*a,h:.2*r},landscape_patient_group:{w:.01*a,h:.2*r},landscape_group:{w:.59*a,h:.2*r},landscape_option:{w:.1*a,h:.2*r},landscape_gene:{w:.15*a,h:.65*r},landscape_patient_heatmap:{w:.01*a,h:.65*r},landscape_heatmap:{w:.59*a,h:.65*r},landscape_pq:{w:.1*a,h:.65*r}};return e.call(t.setSize(i,a,r),o),n.ids},t.chart.variants=function(i,a,r){var o={variants_title:{w:.95*a,h:.05*r},variants_needle:{w:.85*a,h:.85*r},variants_legend:{w:.15*a,h:.85*r},variants_navi:{w:.85*a,h:.1*r}};return e.call(t.setSize(i,a,r),o),n.ids},t.chart.expression=function(i,a,r){var o={expression_title:{w:a,h:.05*r},expression_survival:{w:.4*a,h:.95*r},expression_bar:{w:.4*a,h:.4*r},expression_function:{w:.2*a,h:.05*r},expression_color_mapping:{w:.2*a,h:.05*r},expression_bar_legend:{w:.2*a,h:.3*r},expression_scatter:{w:.4*a,h:.3*r},expression_scatter_empty:{w:.2*a,h:.2*r},expression_scatter_legend:{w:.2*a,h:.1*r},expression_heatmap:{w:.4*a,h:.25*r},expression_geneset:{w:.2*a,h:.05*r},expression_color_gradient:{w:.2*a,h:.1*r}};return e.call(t.setSize(i,a,r),o),n.ids},t}(size||{}),survival=function(t){"use strict";function e(t){function e(t,e,n,i){var a={};a[t]={case_id:t,months:e,status:n},i.push(a)}var n={os:[],dfs:[]},i={os:[],dfs:[]},a={os:[],dfs:[]};return util.loop(t,function(t,r){if(t){var o=t.os_days/30,l=t.dfs_days/30;n.os.push(o),n.dfs.push(l),null!=o&&null!=t.os_status&&e(t.participant_id,o,t.os_status,i.os),null!=l&&null!=t.dfs_status&&e(t.participant_id,l,t.dfs_status,i.dfs),e(t.participant_id,o,t.os_status,a.os),e(t.participant_id,o,t.dfs_status,a.dfs)}}),{month:n,pure:i,all:a}}function n(t,e){var n=document.createElement("input");return n.id=t+"_survival",n.name="tabs",n.type="radio",n.checked=0===e,n}function i(t,e){var n=document.createElement("label");return n.htmlFor=t+"_survival",n.innerHTML=e,n}function a(t,e){var n=document.createElement("div");return n.id=t,n}function r(t,e){document.querySelector(t).innerHTML="";for(var r=document.querySelector(t),o=0,l=e.length;o<l;o++){var s=e[o],c=e[o].toLowerCase();r.appendChild(n(c,o)),r.appendChild(i(c,s))}for(var o=0,l=e.length;o<l;o++){var u=a(e[o].toLowerCase());u.appendChild(a(e[o].toLowerCase()+"_survival_curve")),u.appendChild(a(e[o].toLowerCase()+"_stat_table")),r.appendChild(u)}}return function(t){var n=e(t.data).pure;r(t.element,["OS","DFS"]),SurvivalTab.init(t.divisionData,n)}}(),util=function(t){"use strict";return t.d3v4=function(){return 0!==d3.version.indexOf("3")},t.camelCase=function(t){return t.substring(0,1).toUpperCase()+t.substring(1).toLowerCase()},t.loop=function(e,n){if("Array"===t.varType(e))for(var i=0,a=e.length;i<a;i++)n.call(this,e[i],i);else if("Object"===t.varType(e))for(var r in e)n.call(this,r,e[r])},t.cloneObject=function(e){if(null===e||"object"!=typeof e)return e;var n=e.constructor();return t.loop(e,function(t,i){e.hasOwnProperty(t)&&(n[t]=e[t])}),n},t.varType=function(t){var e=Object.prototype.toString.call(t);return e.substring(e.indexOf(" ")+1,e.indexOf("]"))},t.keyToArr=function(e){var n=[];return t.loop(e,function(t,e){n.push(t)}),n},t.minmax=function(t,e){return arguments.length<2?{min:Math.min.apply(null,t),max:Math.max.apply(null,t)}:{min:Math.min.call(null,t,e),max:Math.max.call(null,t,e)}},t.removeWhiteSpace=function(t){return t.replace(/\s/gi,"")},String.prototype.replaceAt=function(t,e){return this.substr(0,t)+e+this.substr(t+e.length)},Array.prototype.fill=function(t,e){for(var n=0;n<t;n++)this.push(e);return this},t}(util||{}),variants=function(t){"use strict";function e(){f.div.title=document.querySelector("#variants_title"),f.div.title.innerHTML=f.origin.variants.title}function n(t,e,n){return["top"===t?e.attr("height")-n[0]:n[0],n[1]]}function i(){var t=["left","top"],e=(new Array).concat(f.data.axis.needle.y);layout.getSVG(f.svg,["needle"],function(i,a){util.loop(t,function(t,i){axis.element(a)[t]({margin:config.variants.axis[t].margin,position:n(t,a,config.variants.axis[t].margin),data:"left"===t?e.reverse():f.data.axis.needle.x,opt:{}})})})}function a(){layout.getSVG(f.svg,["needle"],function(t,e){needle({element:e,lineData:f.data.needle,circleData:f.data.fullNeedle,attr:config.variants.needle.attr,style:config.variants.needle.style,margin:config.variants.needle.margin,xaxis:f.data.axis.needle.x,yaxis:f.data.axis.needle.y})})}function r(){layout.getSVG(f.svg,["needle"],function(t,e){needleGraph({element:e,data:f.data.graph,attr:config.variants.needleGraph.attr,style:config.variants.needleGraph.style,margin:config.variants.needleGraph.margin,text:config.variants.needleGraph.text,xaxis:f.data.axis.needle.x,yaxis:f.data.axis.needle.y})})}function o(){layout.getSVG(f.svg,["navi"],function(t,e){needleNavi({element:e,data:f.data,margin:config.variants.navi.margin,style:config.variants.navi.style,xaxis:f.data.axis.needle.x,yaxis:f.data.axis.needle.y})})}function l(t){layout.getSVG(f.svg,["needle"],function(e,n){var i={},a=config.variants.patient.needle;i.m=size.setMargin(a.margin),i.s=draw.size(n),i.g=render.addGroup(n,i.s.h-i.m.bottom,i.m.left),i.s=scale.get(f.data.axis.needle.x,[i.m.left,i.s.w-i.m.right]),i.len=5,render.triangle({element:i.g.selectAll("#"+n.attr("id")+"_tri"),data:t,attr:{id:function(t,e){return n.attr("id")+"_tri"},points:function(t,e){return a.attr.points?a.attr.points.call(i,t,e):[0,0]}},style:{fill:function(t,e){return a.style.fill?a.style.fill.call(i,t,e):"#000000"},stroke:function(t,e){return a.style.stroke?a.style.stroke.call(i,t,e):"#FFFFFF"},"stroke-width":"3px"}})})}function s(t){layout.getSVG(f.svg,["legend"],function(e,n){var i=config.variants.patient.legend,a=size.setMargin(i.margin);render.addGroup(n,a.top,a.left);legend({element:n,data:t,attr:config.variants.patient.legend.attr,style:config.variants.patient.legend.style,text:config.variants.patient.legend.text,margin:config.variants.patient.legend.margin})})}function c(){l(f.data.patient),s(f.data.patient)}function u(){layout.getSVG(f.svg,["legend"],function(t,e){legend({element:e,data:f.data.type,priority:config.landscape.priority,text:config.variants.legend.text,attr:config.variants.legend.attr,style:config.variants.legend.style,margin:config.variants.legend.margin})})}function d(){i(),u(),a(),o(),r(),c()}function p(t){t.style.background="#F7F7F7"}var f={div:{}};return function(t){console.log("Given Variants data: ",t);var n=document.querySelector(t.element||null),i=parseFloat(t.width||n.style.width||1400),a=parseFloat(t.height||n.style.height||700);f.origin=t.data,f.data=preprocessing.variants(t.data),f.ids=size.chart.variants(n,i,a),f.svg=layout.variants(f.ids,f),p(n),e(),d()}}();